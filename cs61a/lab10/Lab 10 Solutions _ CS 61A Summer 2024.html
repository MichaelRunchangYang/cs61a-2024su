<!DOCTYPE html>
<!-- saved from url=(0032)https://cs61a.org/lab/sol-lab10/ -->
<html lang="en" class="trancy-zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="CS 61A: Structure and Interpretation of Computer Programs">
    <meta name="keywords" content="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS">
    <meta name="author" content="Laryn Qi, Charlotte Le, Raymond Tan">
    
    <meta name="viewport" content="width=device-width">

    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/jquery.min.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/jquery.ba-throttle-debounce.min.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/bootstrap.min.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/hl.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/toggledarkmode.js.下载"></script>
    <script>
        // we aren't registering builtins since
        //      (1) they don't render differently in the current CSS from other names
        //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
        // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
        hljsRegister({
            'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
        });
        hljs.initHighlightingOnLoad();
    </script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/dark-mode.js.下载"></script>
    <link rel="stylesheet" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/css">
    <link rel="stylesheet" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/style.css">
    <link rel="stylesheet" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/mono-blue.css">
    <link rel="icon" href="https://cs61a.org/assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/lab.css">


    <title>
Lab 10 Solutions | CS 61A Summer 2024
</title>
  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://cs61a.org/">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="./Lab 10 Solutions _ CS 61A Summer 2024_files/logo.png">
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://cs61a.org/office-hours">Weekly Schedule</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/lab/sol-lab10/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                External Websites
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://oh.cs61a.org/">Office Hours Queue</a></li>
                <li><a href="https://pythontutor.com/cp/composingprograms.html">Python Tutor</a></li>
                <li><a href="https://code.cs61a.org/">Online Code Editor</a></li>
                <li><a href="https://www.composingprograms.com/">Textbook</a></li>
                <li><a href="https://edstem.org/us/courses/59836/discussion/">Ed</a></li>
                <li><a href="https://sections.cs61a.org/">Sections Tool</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/lab/sol-lab10/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Forms
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/extensions">Request an Extension</a></li>
                <li><a href="https://go.cs61a.org/regrades">Request a Regrade</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/lab/sol-lab10/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/debugging-guide">Debugging Guide</a></li>
                <li><a href="https://cs61a.org/articles/studying">Studying Guide</a></li>
                <li><a href="https://cs61a.org/articles/composition">Composition Guide</a></li>
                <li><a href="https://cs61a.org/articles/pair-programming">Pair Programming Guide</a></li>
                <li><a href="https://cs61a.org/resources/">Past Exams &amp; Websites</a></li>
                <li><a href="https://cs61a.org/articles/campus-res/">Department and Campus</a></li>
                <li><a href="https://cs61a.org/articles/advice/">Advice from Former Students</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="https://cs61a.org/lab/sol-lab10/#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://cs61a.org/instructor">Instructors</a></li>
                <li><a href="https://cs61a.org/staff">TAs &amp; Tutors</a></li>
                <li><a href="https://cs61a.org/contact/">Contact</a></li>
              </ul>
            </li>
            <li><a href="https://cs61a.org/articles/about">Syllabus</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class="row">
  <div class="col-md-9">
    <header>
      <h1>
        
Lab 10 Solutions

        
        
        <ul class="inline-block list-inline">
          <li><a href="https://cs61a.org/lab/sol-lab10/lab10.zip" class="label label-outline">lab10.zip</a></li>
        </ul>
        
        
      </h1>
    </header>
    
<h2>Solution Files</h2>


    
<h1 id="topics">Topics</h1>


<p>Consult this section if you need a refresher on the material for this lab. It's
okay to skip directly to <a href="https://cs61a.org/lab/sol-lab10/#required-questions">the questions</a> and refer back
here should you get stuck.</p>

<br>

        <button id="toggle-1" class="btn btn-outline btn-lg alwaystoggle toggle">
        Interpreters<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-1">


<h2 id="interpreters" class="no-toc">Interpreters</h2>


<p>An interpreter is a program that allows you to interact with the 
computer using a specific language. It takes the code you write, 
interprets it, and then executes the corresponding actions, often 
using a more fundamental language to communicate with the computer 
hardware.</p>

<p>In Project 4, you'll develop an interpreter for the Scheme 
programming language using Python. Interestingly, the Python 
interpreter you've been using throughout this course is primarily 
written in the C programming language. At the lowest level, computers 
operate by interpreting machine code, which is a series of ones and 
zeros that instructs the computer on performing basic tasks such as 
arithmetic operations and data retrieval.</p>

<p>When we talk about an interpreter, there are two languages at work:</p>

<ol>
  <li><strong>The language being interpreted:</strong> For Project 4, this is the Scheme language.</li>
  <li><strong>The implementation language:</strong> This is the language used to create 
  the interpreter itself, which, for Project 4, will be Python.</li>
</ol>

<br>

<p><strong>REPL</strong></p>

<p>A common feature of interpreters is the Read-Eval-Print Loop (REPL), which processes user inputs in a cyclic fashion through three stages:</p>

<ul>
  <li><p><strong>Read:</strong> The interpreter first reads the input string provided by the user. 
  This input goes through a parsing process that involves two key steps:</p>

  <ul>
    <li>The <em>lexical analysis</em> step breaks down the input string into tokens, 
    which are the basic elements or "words" of the language you're 
    interpreting. These tokens represent the smallest units of meaning within the input.</li>
    <li><p>The <em>syntactic analysis</em> step takes the tokens from the previous step and organizes
    them into a data structure that the underlying language can understand. For our 
    Scheme interpreter, we assemble the tokens into a <code>Pair</code> object (similar to a 
    <code>Link</code>), to represent the structure of the original call expression.</p>

    <ul>
      <li>The first item in the <code>Pair</code> represents the operator of the call expression, while the subsequent elements are the operands or arguments upon which the operation will act. Note that these operands can also be call expressions themselves (nested expressions).
      <br></li>
    </ul></li>
  </ul></li>
</ul>

<p>Below is a summary of the read process for a Scheme expression input:<br></p>

<p><img class="img-responsive center-block" src="./Lab 10 Solutions _ CS 61A Summer 2024_files/parser.png" alt="" width="" height=""><br></p>

<!-- 
And here is a summary of how syntactic analysis converts input tokens into <code>Pair</code> objects:<br>

<p><img class="img-responsive center-block" src="assets/to_pair.png" alt="" width="" height=""><br> --><p></p>

<ul>
  <li><p><strong>Eval:</strong> This step evaluates the expressions you've written in that programming
  language to obtain a value. It involves the following two functions:</p>

  <ul>
    <li><code>eval</code> takes an expression and evaluates it based on the language's rules. 
    When the expression is a call expression, <code>eval</code> uses the <code>apply</code> function to obtain the result. 
    It will evaluate the operator and its operands in order. For example, in <code>(add 1 2)</code>, 
    <code>eval</code> would identify <code>add</code> as the operator and <code>1</code> and <code>2</code> as the operands. 
    It evaluates <code>add</code> to ensure it's a valid function and then evaluates <code>1</code> and 
    <code>2</code> to ensure they're valid arguments.</li>
    <li><code>apply</code> takes the evaluated operator (the function) and applies it to the 
    evaluated operands (the arguments). Note that it's possible that, during this process, <code>apply</code> needs to evaluate more expressions (like those found within the function body). This is where <code>apply</code> may call back to <code>eval</code>, and thus these two stages are <em>mutually recursive</em>.</li>
  </ul></li>
  <li><strong>Print:</strong> Display the result of evaluating the user input.</li>
</ul>

<br>
Here's how all the pieces fit together:<br>

<p><img class="img-responsive center-block" src="./Lab 10 Solutions _ CS 61A Summer 2024_files/repl.png" alt="" width="" height=""></p>

</div>
<br>


<h1 id="required-questions">Required Questions</h1>



        <button id="toggle-2" class="btn btn-outline btn-lg alwaystoggle toggle">
        Getting Started Videos<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-2">


<h2 id="getting-started-videos" class="no-toc">Getting Started Videos</h2>


<p xt-marked="ok">These videos may provide some helpful direction for <xt-mark w="tackle" style="color: #ff8861 !important">tackling</xt-mark> the coding
problems on this assignment.</p>

<blockquote><p>To see these videos, you should be logged into your berkeley.edu email.</p></blockquote>


            <iframe width="560" height="315" src="./Lab 10 Solutions _ CS 61A Summer 2024_files/videoseries.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p><a href="https://youtu.be/playlist?list=PLx38hZJ5RLZdwIF0I28zXMYAvd-BQ2nWY"> YouTube link </a></p>
</div>


<h2 id="calculator">Calculator</h2>


<p>An interpreter is a program that executes programs. Today, we will extend the interpreter for Calculator, a simple made-up language that is a subset of Scheme. This lab is like Project 4 in miniature.</p>

<p>The Calculator language includes only the four basic arithmetic operations: <code>+</code>, <code>-</code>, <code>*</code>, and <code>/</code>. These operations can be nested and can take various numbers of arguments, just like in Scheme. A few examples of calculator expressions and their corresponding values are shown below.</p>

<pre><code class="scheme hljs"> calc&gt; (<span class="hljs-name">+</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span>)
 <span class="hljs-number">6</span>

 calc&gt; (<span class="hljs-name">-</span> <span class="hljs-number">5</span>)
 <span class="hljs-number">-5</span>

 calc&gt; (<span class="hljs-name">*</span> (<span class="hljs-name">+</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span>) (<span class="hljs-name">+</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))
 <span class="hljs-number">27</span></code></pre>



<p>Calculator expressions are represented as Python objects:</p>

<ul>
  <li>Numbers are represented using Python numbers.</li>
  <li>The symbols for arithmetic operations are represented using Python strings (e.g. <code>'+'</code>).</li>
  <li>Call expressions are represented using the <code>Pair</code> class below.</li>
</ul>


<h2 id="pair-class">Pair Class</h2>


<p>To represent Scheme lists in Python, we will use the <code>Pair</code> class (in both this lab and the Scheme project). A <code>Pair</code> instance has two attributes: <code>first</code> and <code>rest</code>. <code>Pair</code> is always called on two arguments. To make a list, nest calls to <code>Pair</code> and pass in <code>nil</code> as the second argument of the last pair.</p>

<ul>
  <li>Look familiar? <code>Pair</code> is very similar to <code>Link</code>, the class we used to represent linked lists. They differ in their <code>str</code> representation: printing a <code>Pair</code> instance displays the list using Scheme syntax.</li>
</ul>

<blockquote><p><strong>Note</strong> In the Python code, <code>nil</code> is bound to a user-defined object that represents an empty Scheme list.
Similarly, <code>nil</code> in Scheme evaluates to an empty list.</p></blockquote>

<p>For example, once our interpreter reads in the Scheme expression <code>(+ 2 3)</code>, it is represented as <code>Pair('+', Pair(2, Pair(3, nil)))</code>.</p>

<pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>p = Pair(<span class="hljs-string">'+'</span>, Pair(<span class="hljs-number">2</span>, Pair(<span class="hljs-number">3</span>, nil)))
<span class="hljs-meta">&gt;&gt;&gt; </span>p.first
<span class="hljs-string">'+'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>p.rest
Pair(<span class="hljs-number">2</span>, Pair(<span class="hljs-number">3</span>, nil))
<span class="hljs-meta">&gt;&gt;&gt; </span>p.rest.first
<span class="hljs-number">2</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>print(p)
(+ <span class="hljs-number">2</span> <span class="hljs-number">3</span>)</code></pre>



<p>The <code>Pair</code> class has a <code>map</code> method that takes a one-argument python function <code>fn</code>. It returns the Scheme list that results from applying <code>fn</code> to each element of the Scheme list.</p>

<pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>p.rest.map(<span class="hljs-keyword">lambda</span> x: <span class="hljs-number">2</span> * x)
Pair(<span class="hljs-number">4</span>, Pair(<span class="hljs-number">6</span>, nil))</code></pre>



<br>

        <button id="toggle-3" class="btn btn-outline btn-lg alwaystoggle toggle">
        Pair Class<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-3">

<p>Here is the <code>Pair</code> class and <code>nil</code> object (<code>__str__</code> and <code>__repr__</code> methods not
shown).</p>

<pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pair</span>:</span>
    <span class="hljs-string">"""Represents the built-in pair data structure in Scheme."""</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, first, rest)</span>:</span>
        self.first = first
        self.rest = rest

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">map</span><span class="hljs-params">(self, fn)</span>:</span>
        <span class="hljs-string">"""Return a Scheme list after mapping Python function FN to SELF."""</span>
        mapped = fn(self.first)
        <span class="hljs-keyword">if</span> self.rest <span class="hljs-keyword">is</span> nil <span class="hljs-keyword">or</span> isinstance(self.rest, Pair):
            <span class="hljs-keyword">return</span> Pair(mapped, self.rest.map(fn))
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">'ill-formed list'</span>)</code></pre>



<pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">nil</span>:</span>
    <span class="hljs-string">"""The empty list"""</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">map</span><span class="hljs-params">(self, fn)</span>:</span>
        <span class="hljs-keyword">return</span> self

nil = nil() <span class="hljs-comment"># Assignment hides the nil class; there is only one instance</span></code></pre>



</div>
<br>

<page-break>


<h3 id="q1-using-pair">Q1: Using Pair</h3>


<p>Answer the following questions about a <code>Pair</code> instance
representing the Calculator expression <code>(+ (- 2 4) 6 8)</code>.</p>

<p>Use Ok to test your understanding:</p><pre style="margin-bottom:0;"><code class="nohighlight">python3 ok -q using_pair -u</code><button id="copy-code-python3ok-qusing_pair-u" class="inline-copy-button"><code class="nohighlight"><div class="copy-tooltip"><span>Copy</span></div>✂️</code></button></pre>
        <script>
        document.getElementById("copy-code-python3ok-qusing_pair-u").onclick = () => copyCode('python3 ok -q using_pair -u', "copy-code-python3ok-qusing_pair-u");
        </script>
        <br>


<h2 id="calculator-evaluation">Calculator Evaluation</h2>


<p>For Question 2 (New Procedure) and Question 4 (Saving Values), you'll need to update the <code>calc_eval</code> function below, which evaluates a Calculator expression. For Question 2, you'll determine what are the <code>operator</code> and <code>operands</code> for a call expression in Scheme as well as how to apply a procedure to arguments the <code>calc_apply</code> line. For Question 4, you'll determine how to look up the value of symbols previously defined.</p>

<solution>

<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_eval</span><span class="hljs-params">(exp)</span>:</span>
    <span class="hljs-string">"""
    &gt;&gt;&gt; calc_eval(Pair("define", Pair("a", Pair(1, nil))))
    'a'
    &gt;&gt;&gt; calc_eval("a")
    1
    &gt;&gt;&gt; calc_eval(Pair("+", Pair(1, Pair(2, nil))))
    3
    """</span>
    <span class="hljs-keyword">if</span> isinstance(exp, Pair):
<div class="sol-highlight">        operator = exp.first</div><div class="sol-highlight">        operands = exp.rest</div>        <span class="hljs-keyword">if</span> operator == <span class="hljs-string">'and'</span>: <span class="hljs-comment"># and expressions</span>
            <span class="hljs-keyword">return</span> eval_and(operands)
        <span class="hljs-keyword">elif</span> operator == <span class="hljs-string">'define'</span>: <span class="hljs-comment"># define expressions</span>
            <span class="hljs-keyword">return</span> eval_define(operands)
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># Call expressions</span>
<div class="sol-highlight">            <span class="hljs-keyword">return</span> calc_apply(calc_eval(operator), operands.map(calc_eval))</div>    <span class="hljs-keyword">elif</span> exp <span class="hljs-keyword">in</span> OPERATORS:   <span class="hljs-comment"># Looking up procedures</span>
        <span class="hljs-keyword">return</span> OPERATORS[exp]
    <span class="hljs-keyword">elif</span> isinstance(exp, int) <span class="hljs-keyword">or</span> isinstance(exp, bool):   <span class="hljs-comment"># Numbers and booleans</span>
        <span class="hljs-keyword">return</span> exp
<div class="sol-highlight">    <span class="hljs-keyword">elif</span> exp <span class="hljs-keyword">in</span> bindings:   <span class="hljs-comment"># Looking up variables</span></div><div class="sol-highlight"><span class="hljs-comment">        return bindings[exp]</span></div></code></pre>

</solution>


<h3 id="q2-new-procedure">Q2: New Procedure</h3>


<p>Add the <code>//</code> operation to Calculator, a floor-division procedure such that <code>(// dividend divisor)</code> returns the result of dividing <code>dividend</code> by <code>divisor</code>, ignoring the remainder (<code>dividend // divisor</code> in Python). Handle multiple inputs as illustrated in the following example: <code>(// dividend divisor1 divisor2 divisor3)</code> evaluates to <code>(((dividend // divisor1) // divisor2) // divisor3)</code> in Python. Assume every call to <code>//</code> has at least two arguments.</p>

<blockquote><p><em>Hint:</em> You will need to modify both the <code>calc_eval</code> and <code>floor_div</code> methods for this question!</p></blockquote>

<pre><code class="scheme hljs">calc&gt; (<span class="hljs-name">//</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>)
<span class="hljs-number">1</span>
calc&gt; (<span class="hljs-name">//</span> <span class="hljs-number">5</span> <span class="hljs-number">2</span>)
<span class="hljs-number">2</span>
calc&gt; (<span class="hljs-name">//</span> <span class="hljs-number">28</span> (<span class="hljs-name">+</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>) <span class="hljs-number">1</span>)
<span class="hljs-number">14</span></code></pre>



<blockquote><p><em>Hint:</em> Make sure that every element in a <code>Pair</code> (the operator and all operands) will be <code>calc_eval</code>-uated once, so that we can correctly apply the relevant Python operator to operands! You may find the <code>map</code> method of the <code>Pair</code> class useful for this.</p></blockquote>

<solution>

<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">floor_div</span><span class="hljs-params">(args)</span>:</span>
    <span class="hljs-string">"""
    &gt;&gt;&gt; floor_div(Pair(100, Pair(10, nil)))
    10
    &gt;&gt;&gt; floor_div(Pair(5, Pair(3, nil)))
    1
    &gt;&gt;&gt; floor_div(Pair(1, Pair(1, nil)))
    1
    &gt;&gt;&gt; floor_div(Pair(5, Pair(2, nil)))
    2
    &gt;&gt;&gt; floor_div(Pair(23, Pair(2, Pair(5, nil))))
    2
    &gt;&gt;&gt; calc_eval(Pair("//", Pair(4, Pair(2, nil))))
    2
    &gt;&gt;&gt; calc_eval(Pair("//", Pair(100, Pair(2, Pair(2, Pair(2, Pair(2, Pair(2, nil))))))))
    3
    &gt;&gt;&gt; calc_eval(Pair("//", Pair(100, Pair(Pair("+", Pair(2, Pair(3, nil))), nil))))
    20
    """</span>
<div class="sol-highlight">    result = args.first
    divisors = args.rest
    <span class="hljs-keyword">while</span> divisors != nil:
        divisor = divisors.first
        result //= divisor
        divisors = divisors.rest
    <span class="hljs-keyword">return</span> result</div></code></pre>

</solution>

<p>Use Ok to test your code:</p><pre style="margin-bottom:0;"><code class="nohighlight">python3 ok -q floor_div</code><button id="copy-code-python3ok-qfloor_div" class="inline-copy-button"><code class="nohighlight"><div class="copy-tooltip"><span>Copy</span></div>✂️</code></button></pre>
        <script>
        document.getElementById("copy-code-python3ok-qfloor_div").onclick = () => copyCode('python3 ok -q floor_div', "copy-code-python3ok-qfloor_div");
        </script>
        <br>


<h3 id="q3-new-form">Q3: New Form</h3>


<p>Add <code>and</code> expressions to our
Calculator interpreter as well as introduce the Scheme boolean values
<code>#t</code> and <code>#f</code>, represented as Python <code>True</code> and <code>False</code>.
(The examples below assumes conditional operators (e.g. <code>&lt;</code>, <code>&gt;</code>, <code>=</code>, etc) have already been implemented,
but you do not have to worry about them for this question.)</p>

<pre><code class="scheme hljs">calc&gt; (<span class="hljs-name"><span class="hljs-keyword">and</span></span> (<span class="hljs-name">=</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>) <span class="hljs-number">3</span>)
<span class="hljs-number">3</span>
calc&gt; (<span class="hljs-name"><span class="hljs-keyword">and</span></span> (<span class="hljs-name">+</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>) (<span class="hljs-name">&lt;</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>) (<span class="hljs-name">/</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>))
#f
calc&gt; (<span class="hljs-name"><span class="hljs-keyword">and</span></span> <span class="hljs-literal">#f</span> (<span class="hljs-name">+</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>))
#f
calc&gt; (<span class="hljs-name"><span class="hljs-keyword">and</span></span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> (<span class="hljs-name">+</span> <span class="hljs-number">5</span> <span class="hljs-number">1</span>)) <span class="hljs-comment">; 0 is a true value in Scheme!</span>
<span class="hljs-number">6</span></code></pre>



<p>In a call expression, we first evaluate the operator, then evaluate the operands, and finally apply the procedure to its arguments (just like you did for <code>floor_div</code> in the previous question).
However, since <code>and</code> is a special form that short circuits on the first false argument, we cannot evaluate <code>and</code> expressions the same way we evaluate call expressions.  We need to add special logic for forms that don't always evaluate all the sub-expressions.</p>

<blockquote><p><strong>Important</strong>: To check whether some <code>val</code> is a false value in Scheme, use
<code>val is scheme_f</code> rather than <code>val == scheme_f</code>.</p></blockquote>

<solution>

<pre><code class="hljs python">scheme_t = <span class="hljs-literal">True</span>   <span class="hljs-comment"># Scheme's #t</span>
scheme_f = <span class="hljs-literal">False</span>  <span class="hljs-comment"># Scheme's #f</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">eval_and</span><span class="hljs-params">(expressions)</span>:</span>
    <span class="hljs-string">"""
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(1, nil)))
    1
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(False, Pair("1", nil))))
    False
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(1, Pair(Pair("//", Pair(5, Pair(2, nil))), nil))))
    2
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(Pair('+', Pair(1, Pair(1, nil))), Pair(3, nil))))
    3
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(Pair('-', Pair(1, Pair(0, nil))), Pair(Pair('/', Pair(5, Pair(2, nil))), nil))))
    2.5
    &gt;&gt;&gt; calc_eval(Pair("and", Pair(0, Pair(1, nil))))
    1
    &gt;&gt;&gt; calc_eval(Pair("and", nil))
    True
    """</span>
<div class="sol-highlight">    curr, val = expressions, <span class="hljs-literal">True</span>
    <span class="hljs-keyword">while</span> curr <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> nil:
        val = calc_eval(curr.first)
        <span class="hljs-keyword">if</span> val <span class="hljs-keyword">is</span> scheme_f:
            <span class="hljs-keyword">return</span> scheme_f
        curr = curr.rest
    <span class="hljs-keyword">return</span> val</div></code></pre>

</solution>

<p>Use Ok to test your code:</p><pre style="margin-bottom:0;"><code class="nohighlight">python3 ok -q eval_and</code><button id="copy-code-python3ok-qeval_and" class="inline-copy-button"><code class="nohighlight"><div class="copy-tooltip"><span>Copy</span></div>✂️</code></button></pre>
        <script>
        document.getElementById("copy-code-python3ok-qeval_and").onclick = () => copyCode('python3 ok -q eval_and', "copy-code-python3ok-qeval_and");
        </script>
        <br>


<h3 id="q4-saving-values">Q4: Saving Values</h3>


<p>Implement a <code>define</code> special form that binds values to symbols. This should work like <code>define</code> in Scheme: <code>(define &lt;symbol&gt; &lt;expression&gt;)</code> first evaluates the <code>expression</code>, then binds the <code>symbol</code> to its value. The whole <code>define</code> expression evaluates to the <code>symbol</code>.</p>

<pre><code class="scheme hljs">calc&gt; (<span class="hljs-name"><span class="hljs-keyword">define</span></span> a <span class="hljs-number">1</span>)
a
calc&gt; a
<span class="hljs-number">1</span></code></pre>



<p>This is a more involved change. Here are the 4 steps involved:</p>

<ol>
  <li>Add a <code>bindings</code> dictionary that will store the symbols and correspondings values (done for you).</li>
  <li>Identify when the define form is given to <code>calc_eval</code> (done for you).</li>
  <li>Allow symbols bound to values to be looked up in <code>calc_eval</code>.</li>
  <li>Write the function <code>eval_define</code> which should add symbols and values to the bindings dictionary.</li>
</ol>

<solution>

<pre><code class="hljs python">bindings = {}

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">eval_define</span><span class="hljs-params">(expressions)</span>:</span>
    <span class="hljs-string">"""
    &gt;&gt;&gt; eval_define(Pair("a", Pair(1, nil)))
    'a'
    &gt;&gt;&gt; eval_define(Pair("b", Pair(3, nil)))
    'b'
    &gt;&gt;&gt; eval_define(Pair("c", Pair("a", nil)))
    'c'
    &gt;&gt;&gt; calc_eval("c")
    1
    &gt;&gt;&gt; calc_eval(Pair("define", Pair("d", Pair("//", nil))))
    'd'
    &gt;&gt;&gt; calc_eval(Pair("d", Pair(4, Pair(2, nil))))
    2
    """</span>
<div class="sol-highlight">    symbol, value = expressions.first, calc_eval(expressions.rest.first)
    bindings[symbol] = value
    <span class="hljs-keyword">return</span> symbol</div></code></pre>

</solution>

<p>Use Ok to test your code:</p><pre style="margin-bottom:0;"><code class="nohighlight">python3 ok -q eval_define</code><button id="copy-code-python3ok-qeval_define" class="inline-copy-button"><code class="nohighlight"><div class="copy-tooltip"><span>Copy</span></div>✂️</code></button></pre>
        <script>
        document.getElementById("copy-code-python3ok-qeval_define").onclick = () => copyCode('python3 ok -q eval_define', "copy-code-python3ok-qeval_define");
        </script>
        <br>


<h2 id="check-your-score-locally">Check Your Score Locally</h2>

<p>You can locally check your score on each question of this assignment by running</p>

<pre><code class="hljs sql">python3 ok <span class="hljs-comment">--score</span></code></pre>

<p><strong>This does NOT submit the assignment!</strong> When you are satisfied with your score, submit the assignment to Gradescope to receive credit for it.</p>


<h1 id="submit-assignment">Submit Assignment</h1>


<p>Submit this assignment by uploading any files you've edited <strong>to the appropriate Gradescope assignment.</strong> <a href="https://cs61a.org/lab/lab00/#submit-with-gradescope">Lab 00</a> has detailed instructions.</p>

<p>In addition, all students who are <strong>not</strong> in the mega lab must submit the attendance form for credit. Ask your section TA for the link! Submit this form for each section, whether you attended lab or missed it for a good reason. The attendance form is not required for mega section students.</p>

  </page-break></div>

  <div class="col-md-3 sticky">
    <nav class="hidden-print hidden-sm hidden-xs sidebar">
      <ul class="nav nav-stacked noselect">
  <li><a href="https://cs61a.org/lab/sol-lab10/#topics">Topics</a></li>
  <li><a href="https://cs61a.org/lab/sol-lab10/#required-questions">Required Questions</a></li>
  <ul class="nav nav-stacked noselect">
    <li><a href="https://cs61a.org/lab/sol-lab10/#calculator">Calculator</a></li>
    <li><a href="https://cs61a.org/lab/sol-lab10/#pair-class">Pair Class</a></li>
    <ul class="nav nav-stacked noselect">
      <li><a href="https://cs61a.org/lab/sol-lab10/#q1-using-pair">Q1: Using Pair</a></li>
    </ul>
    <li><a href="https://cs61a.org/lab/sol-lab10/#calculator-evaluation">Calculator Evaluation</a></li>
    <ul class="nav nav-stacked noselect">
      <li><a href="https://cs61a.org/lab/sol-lab10/#q2-new-procedure">Q2: New Procedure</a></li>
      <li><a href="https://cs61a.org/lab/sol-lab10/#q3-new-form">Q3: New Form</a></li>
      <li><a href="https://cs61a.org/lab/sol-lab10/#q4-saving-values">Q4: Saving Values</a></li>
    </ul>
    <li><a href="https://cs61a.org/lab/sol-lab10/#check-your-score-locally">Check Your Score Locally</a></li>
  </ul>
  <li><a href="https://cs61a.org/lab/sol-lab10/#submit-assignment">Submit Assignment</a></li>
</ul>
    </nav>
  </div>
</div>

    </main>

    <!-- <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/weekly">Weekly Schedule</a></li>
            <li><a href="/office-hours">Office Hours</a></li>
            <li><a href="/staff">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/resources">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/studying">Studying Guide</a></li>
            <li><a href="/articles/debugging">Debugging Guide</a></li>
            <li><a href="/articles/composition">Composition Guide</a></li>
            <li><a href="/articles/pair-programming">Pair Programming</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/articles/about">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/about#assignments">Assignments</a></li>
            <li><a href="/articles/about#exams">Exams</a></li>
            <li><a href="/articles/about#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer> -->

    

    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/loader.min.js.下载"></script>
  <link rel="stylesheet" data-name="vs/editor/editor.main" href="./Lab 10 Solutions _ CS 61A Summer 2024_files/editor.main.min.css">
  <script>
      require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
      window.MonacoEnvironment = { getWorkerUrl: () => URL.createObjectURL(new Blob([`
      self.MonacoEnvironment = {
          baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
      };
      importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
  `], { type: 'text/javascript' }))
  };
  </script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/jsplumb.min.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/network_storage.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/storable.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/editor.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/copy-button.js.下载"></script>
    <script src="./Lab 10 Solutions _ CS 61A Summer 2024_files/env-diagram.js.下载"></script>
    
<!-- <script src="/assets/js/sketchy.js"></script> -->
<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      event.preventDefault();
      goToId(this.hash);
      document.location.hash = this.hash;
    }
  });
</script>

  
<deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://fancfknaplihpclbhbpclnmmjcjanbaf/build/content.css"><div dir="ltr" style="visibility: initial !important;"><div class="dl-input-translation-container svelte-95aucy"><div></div></div></div></template></deepl-input-controller></body><link rel="stylesheet" asset="eduser.css" href="chrome-extension://mjdbhokoopacimoekfgkcoogikbfgngb/assets/eduser.css"></html>